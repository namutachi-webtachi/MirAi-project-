<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MirAi Project - Th∆∞ Vi·ªán</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ff6b81">
</head>
<body>
    <div id="loading">ƒêang t·∫£i th∆∞ vi·ªán...</div>

    <div class="container">
        <!-- Header (S·∫Ω ƒë∆∞·ª£c JS t√πy ch·ªânh) -->
        <div class="glass-box" style="text-align: center;">
            <h1 id="web-name">ƒêang t·∫£i...</h1>
            <p class="tagline" id="sub-title">Th∆∞ vi·ªán l∆∞u tr·ªØ MirAi</p>
            <div style="margin-top: 20px; display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
                <button class="btn" onclick="toggleTheme()">üåô Giao di·ªán</button>
                <a href="lore_hub.html" id="back-button" class="btn btn-outline">‚¨Ö Quay v·ªÅ Databook</a>
            </div>
        </div>

       <!-- Search & List -->
        <div class="glass-box">
            <input type="text" id="search-input" class="search-box" placeholder="üîç T√¨m ki·∫øm m·ª•c...">
            <hr style="border: 0; border-top: 1px solid rgba(0,0,0,0.1); margin: 20px 0;">
            <h3 id="list-title">üìñ M·ª•c l·ª•c</h3>
            <div id="chapter-list" class="chapter-list"></div>
        </div>
    </div>
    
    <!-- Player & Footer (Gi·ªØ nguy√™n) -->
    <div id="bgm-player" onclick="toggleBGM()">
        <div id="bgm-icon"></div>
        <div id="bgm-controls">‚ñ∂Ô∏è</div>
    </div>
    <footer style="text-align: center; margin-top: 50px; padding: 20px;">
        <p style="font-size: 0.8rem; opacity: 0.7;">&copy; 2026 MirAi Project - NamuTachi</p>
    </footer>

    <!-- Scripts -->
    <script src="config.js"></script>
    <script src="js/script.js"></script>
    <script>
        // LOGIC ƒêA NƒÇNG CHO list.html
        document.addEventListener("DOMContentLoaded", async () => {
            // 1. L·∫•y t√™n database t·ª´ URL (VD: ?db=wiki)
            const urlParams = new URLSearchParams(window.location.search);
            const dbName = urlParams.get('db');

            if (!dbName) {
                document.getElementById('web-name').innerText = "L·ªói";
                document.getElementById('chapter-list').innerHTML = "Kh√¥ng t√¨m th·∫•y th∆∞ vi·ªán.";
                hideLoading();
                return;
            }

            // 2. C·∫≠p nh·∫≠t ti√™u ƒë·ªÅ v√† c√°c text
            const titleMap = {
                'wiki': 'Wiki Nh√¢n V·∫≠t',
                'tech': 'C√¢y C√¥ng Ngh·ªá',
                'prequel': 'Ti·ªÅn Truy·ªán',
                'arcs': 'T·ªïng Quan C·ªët Truy·ªán'
            };
            const pageTitle = titleMap[dbName] || 'Th∆∞ Vi·ªán';
            document.title = pageTitle + " - MirAi";
            document.getElementById('web-name').innerText = pageTitle;
            document.getElementById('list-title').innerText = `üìñ C√°c m·ª•c trong ${pageTitle}`;

            // 3. G·ªçi h√†m initIndexPage ƒë√£ ƒë∆∞·ª£c n√¢ng c·∫•p trong script.js
            // Ta s·∫Ω truy·ªÅn v√†o t√™n file JSON v√† t√™n th∆∞ m·ª•c t∆∞∆°ng ·ª©ng
            const jsonFile = `data_${dbName}.json`;
            const folderPrefix = dbName;
            
            // H√†m n√†y n·∫±m trong script.js, ta ch·ªâ c·∫ßn g·ªçi n√≥
            await initIndexPage(jsonFile, folderPrefix);
        });
    </script>
</body>
</html>
