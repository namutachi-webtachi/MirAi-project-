<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>404 Not Found</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        body { background-color: #000; margin: 0; overflow: hidden; font-family: monospace; }
        #admin-panel { display: none; padding-bottom: 50px; background: #f4f4f4; min-height: 100vh; overflow-y: auto; }
        .reveal { animation: fadeIn 1s forwards; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { flex: 1; padding: 10px; cursor: pointer; background: #ddd; border: none; border-radius: 5px; font-weight: bold; }
        .tab-btn.active { background: var(--primary); color: white; }
        .chapter-row { display: flex; justify-content: space-between; align-items: center; background: white; padding: 10px; margin-bottom: 8px; border-radius: 8px; }
        .action-group { display: flex; gap: 5px; }
        .btn-action { padding: 5px 12px; border-radius: 4px; cursor: pointer; border: none; color: white; font-weight: bold; }
        .edit-btn { background: #f39c12; }
        .del-btn { background: #e74c3c; }

        /* === CSS CHO KHUNG HÆ¯á»šNG DáºªN (Má»šI) === */
        .guide-box { border: 1px dashed #ccc; border-radius: 8px; margin-bottom: 15px; background: #f9f9f9; }
        .guide-header { padding: 12px; font-weight: bold; cursor: pointer; user-select: none; color: #34495e; }
        .guide-header:hover { background: #f0f0f0; }
        .guide-content { display: none; padding: 0 15px 15px 15px; border-top: 1px dashed #ccc; }
        .guide-content ul { padding-left: 20px; margin: 10px 0 0 0; }
        .guide-content li { margin-bottom: 8px; line-height: 1.5; }
        code { background: #e0e0e0; padding: 2px 5px; border-radius: 4px; font-family: monospace; }
        /* ========================================= */
    </style>
</head>
<body>
    <div id="black-screen" style="height: 100vh; width: 100vw;"></div>

    <div id="admin-panel" class="container">
        <header class="glass-box" style="text-align: center; margin-top: 30px;">
            <h2 style="color: var(--primary);">â˜ ï¸ GOD MODE ADMIN</h2>
            <a href="index.html" class="btn btn-outline">â¬… ThoÃ¡t</a>
        </header>

        <div class="glass-box">
            <h3>ğŸ”‘ Token GitHub</h3>
            <input type="password" id="token" placeholder="GitHub Token (ghp_...)" onchange="saveToken()">
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('new')">ğŸ“ ÄÄƒng Má»›i</button>
            <button class="tab-btn" onclick="switchTab('list')">ğŸ“‹ Quáº£n LÃ½ (Sá»­a/XÃ³a)</button>
        </div>

        <div id="tab-editor" class="glass-box">
            <h3 id="editor-title">ğŸ“ Soáº¡n Tháº£o</h3>
            <input type="hidden" id="edit-index" value="">
            <input type="hidden" id="edit-file-sha" value="">

            <input type="text" id="chapTitle" placeholder="TiÃªu Ä‘á» chÆ°Æ¡ng">
            
            <!-- === KHUNG HÆ¯á»šNG DáºªN TÃCH Há»¢P (Má»šI) === -->
            <div class="guide-box">
                <div class="guide-header" onclick="toggleGuide()">
                    ğŸ“š Quy Táº¯c Soáº¡n Tháº£o (Báº¥m Ä‘á»ƒ xem/áº©n)
                </div>
                <div class="guide-content" id="guide-content">
                    <ul>
                        <li><b>Lá»i thoáº¡i:</b> Báº¯t Ä‘áº§u báº±ng <code>[TÃªn]:</code> (VÃ­ dá»¥: <code>[Minh]: ChÃ o cáº­u</code>)</li>
                        <li><b>Suy nghÄ© / Ã‚m thanh:</b> Äáº·t trong ngoáº·c Ä‘Æ¡n <code>(...)</code> (VÃ­ dá»¥: <code>(MÃ¬nh nÃªn lÃ m gÃ¬?)</code>)</li>
                        <li><b>Ngáº¯t cáº£nh:</b> DÃ¹ng 3 dáº¥u sao <code>***</code> trÃªn má»™t dÃ²ng riÃªng.</li>
                    </ul>
                </div>
            </div>
            <!-- ========================================= -->
            
            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                <div class="file-drop" style="flex: 1;" onclick="document.getElementById('txtInput').click()">ğŸ“‚ Import TXT</div>
                <div class="file-drop" style="flex: 1;" onclick="document.getElementById('imgInput').click()">ğŸ–¼ Up áº¢nh</div>
                <input type="file" id="txtInput" accept=".txt" hidden onchange="handleTxt()">
                <input type="file" id="imgInput" accept="image/*" hidden onchange="handleImg()">
            </div>
            <p id="imgStatus" style="text-align: center; color: blue; font-size: 0.8rem;"></p>

            <button class="btn" onclick="autoFormat()" style="width: 100%; background: #2ecc71; margin-bottom: 10px;">âœ¨ Tá»± Äá»™ng Äá»‹nh Dáº¡ng</button>
            <textarea id="content" rows="15" placeholder="Ná»™i dung..."></textarea>
            
            <button id="publishBtn" class="btn" onclick="publish()" style="width: 100%; margin-top: 10px;">ğŸš€ ÄÄ‚NG BÃ€I</button>
            <button id="cancelBtn" class="btn" onclick="resetForm()" style="width: 100%; margin-top: 10px; background: gray; display: none;">Há»§y Sá»­a</button>
            <p id="status" style="text-align: center; font-weight: bold; margin-top: 10px;"></p>
        </div>

        <div id="tab-list" class="glass-box" style="display: none;">
            <h3>ğŸ“‹ Danh sÃ¡ch chÆ°Æ¡ng</h3>
            <button class="btn btn-outline" onclick="loadList()" style="width: 100%; margin-bottom: 15px;">ğŸ”„ LÃ m má»›i</button>
            <div id="list-container">Äang táº£i...</div>
        </div>
    </div>

    <script src="config.js"></script>
    <script>
        // === ğŸ” Máº¬T KHáº¨U ===
        const SECRET_PASS = "2006";

        // === ğŸ¤– HÃ€M "AI" Äá»ŠNH Dáº NG ===
        function autoFormat() {
            const textArea = document.getElementById('content'); let text = textArea.value;
            text = text.replace(/\r\n/g, "\n").replace(/\n{2,}/g, "\n\n").replace(/(?<!\n)\n(?!\n)/g, "\n\n");
            text = text.replace(/^\[(.*?)\]:\s*(.*)$/gm, '**[$1]:** $2');
            text = text.replace(/\((.*?)\)/g, '*($1)*');
            text = text.replace(/^\s*\*\*\*\s*$/gm, '---');
            textArea.value = text;
            alert("âœ… ÄÃ£ tá»± Ä‘á»™ng Ä‘á»‹nh dáº¡ng xong!");
        }

        // === HÃ€M Báº¬T/Táº®T HÆ¯á»šNG DáºªN (Má»šI) ===
        function toggleGuide() {
            const content = document.getElementById('guide-content');
            content.style.display = (content.style.display === 'block') ? 'none' : 'block';
        }

        // === CÃC HÃ€M CÅ¨ GIá»® NGUYÃŠN ===
        console.log("%cğŸ›‘ SYSTEM LOCKED", "color: red; font-size: 30px;");
        console.log("%cGÃµ: login('PASSWORD')", "color: yellow;");
        window.login = function(pass) {
            if(pass === SECRET_PASS) {
                console.clear(); console.log("%câœ… ACCESS GRANTED", "color: lime;");
                document.getElementById('black-screen').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'block';
                document.body.style.backgroundColor = "#f4f4f4";
                document.body.style.backgroundImage = `url('${CONFIG.bgImage}')`;
                document.body.style.overflow = "auto";
                if(localStorage.getItem('gh_token')) document.getElementById('token').value = localStorage.getItem('gh_token');
            } else { console.log("%câŒ WRONG PASSWORD", "color: red;"); }
        }
        function switchTab(t) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            if(t==='new'){document.getElementById('tab-editor').style.display='block';document.getElementById('tab-list').style.display='none';document.querySelector('button[onclick="switchTab(\'new\')"]').classList.add('active');}
            else{document.getElementById('tab-editor').style.display='none';document.getElementById('tab-list').style.display='block';document.querySelector('button[onclick="switchTab(\'list\')"]').classList.add('active');loadList();}
        }
        async function loadList(){
            const t=document.getElementById('token').value; if(!t)return;
            try{const res=await fetch(`https://api.github.com/repos/${CONFIG.adminUser}/${CONFIG.repoName}/contents/data.json?t=${Date.now()}`);const data=await res.json();
            window.chapters=JSON.parse(decodeURIComponent(escape(atob(data.content))));window.jsonSha=data.sha;const c=document.getElementById('list-container');c.innerHTML='';
            window.chapters.forEach((h,i)=>{c.innerHTML+=`<div class="chapter-row"><div><b>#${i+1}:</b> ${h.title}</div><div class="action-group"><button class="btn-action edit-btn" onclick="editChap(${i})">âœï¸</button><button class="btn-action del-btn" onclick="delChap(${i})">ğŸ—‘ï¸</button></div></div>`;});
            }catch(e){document.getElementById('list-container').innerHTML="Lá»—i: "+e;}
        }
        async function editChap(i){
            const c=window.chapters[i];switchTab('new');document.getElementById('status').innerText="Äang táº£i...";
            try{const res=await fetch(`https://api.github.com/repos/${CONFIG.adminUser}/${CONFIG.repoName}/contents/${c.file}?t=${Date.now()}`);const d=await res.json();
            document.getElementById('chapTitle').value=c.title;document.getElementById('content').value=decodeURIComponent(escape(atob(d.content)));
            document.getElementById('edit-index').value=i;document.getElementById('edit-file-sha').value=d.sha;
            document.getElementById('editor-title').innerText="âœï¸ Sá»­a: "+c.title;document.getElementById('publishBtn').innerText="ğŸ’¾ Cáº¬P NHáº¬T";
            document.getElementById('publishBtn').style.background="#f39c12";document.getElementById('cancelBtn').style.display="block";
            document.getElementById('status').innerText="";}catch(e){alert(e);}
        }
        async function delChap(i){
            const c=window.chapters[i]; const t=document.getElementById('token').value;
            if(!confirm(`âš ï¸ XÃ“A VÄ¨NH VIá»„N:\n"${c.title}"?`)) return;
            document.getElementById('list-container').innerHTML="Äang xÃ³a...";
            try{const fR=await fetch(`https://api.github.com/repos/${CONFIG.adminUser}/${CONFIG.repoName}/contents/${c.file}`);const fD=await fR.json();
            await fetch(`https://api.github.com/repos/${CONFIG.adminUser}/${CONFIG.repoName}/contents/${c.file}`,{method:'DELETE',headers:{Authorization:`token ${t}`},body:JSON.stringify({message:`Delete ${c.title}`,sha:fD.sha})});
            window.chapters.splice(i,1);const jB=btoa(unescape(encodeURIComponent(JSON.stringify(window.chapters,null,2))));
            await fetch(`https://api.github.com/repos/${CONFIG.adminUser}/${CONFIG.repoName}/contents/data.json`,{method:'PUT',headers:{Authorization:`token ${t}`},body:JSON.stringify({message:"Del item",content:jB,sha:window.jsonSha})});
            alert("âœ… ÄÃ£ xÃ³a!");loadList();}catch(e){alert(e);loadList();}
        }
        async function publish(){
            const t=document.getElementById('token').value,ti=document.getElementById('chapTitle').value,c=document.getElementById('content').value,i=document.getElementById('edit-index').value,s=document.getElementById('status');
            if(!t||!ti||!c)return alert("Thiáº¿u thÃ´ng tin!");s.innerText="Äang xá»­ lÃ½...";
            try{const jR=await fetch(`https://api.github.com/repos/${CONFIG.adminUser}/${CONFIG.repoName}/contents/data.json`,{headers:{Authorization:`token ${t}`}});const jD=await jR.json();
            let l=JSON.parse(decodeURIComponent(escape(atob(jD.content))));let p,h=null;
            if(i!==""){p=l[i].file;h=document.getElementById('edit-file-sha').value;l[i].title=ti;}
            else{const d=`chap_${Date.now()}`;p=`chapters/${d}.md`;l.push({id:d,title:ti,file:p});}
            const b64=btoa(unescape(encodeURIComponent(c))),b={message:`Upd ${ti}`,content:b64};if(h)b.sha=h;
            await fetch(`https://api.github.com/repos/${CONFIG.adminUser}/${CONFIG.repoName}/contents/${p}`,{method:'PUT',headers:{Authorization:`token ${t}`},body:JSON.stringify(b)});
            const jB=btoa(unescape(encodeURIComponent(JSON.stringify(l,null,2))));
            await fetch(`https://api.github.com/repos/${CONFIG.adminUser}/${CONFIG.repoName}/contents/data.json`,{method:'PUT',headers:{Authorization:`token ${t}`},body:JSON.stringify({message:"Upd list",content:jB,sha:jD.sha})});
            s.innerText="ğŸ‰ THÃ€NH CÃ”NG!";if(i!==""){switchTab('list');resetForm();}else{document.getElementById('content').value='';document.getElementById('chapTitle').value='';}
            }catch(e){s.innerText="Lá»—i: "+e;}
        }
        function resetForm(){document.getElementById('chapTitle').value='';document.getElementById('content').value='';document.getElementById('edit-index').value='';document.getElementById('edit-file-sha').value='';document.getElementById('publishBtn').innerText="ğŸš€ ÄÄ‚NG BÃ€I";document.getElementById('publishBtn').style.background="var(--primary)";document.getElementById('cancelBtn').style.display="none";document.getElementById('editor-title').innerText="ğŸ“ Soáº¡n Tháº£o";}
        function saveToken(){localStorage.setItem('gh_token',document.getElementById('token').value);}
        function handleTxt(){const r=new FileReader();r.onload=e=>document.getElementById('content').value=e.target.result;r.readAsText(document.getElementById('txtInput').files[0]);}
        async function handleImg(){const f=document.getElementById('imgInput').files[0];if(!f)return;const t=document.getElementById('token').value;document.getElementById('imgStatus').innerText="Uploading...";const r=new FileReader();r.readAsDataURL(f);r.onload=async function(){try{const b64=r.result.split(',')[1],n=`images/${Date.now()}_${f.name}`;await fetch(`https://api.github.com/repos/${CONFIG.adminUser}/${CONFIG.repoName}/contents/${n}`,{method:'PUT',headers:{Authorization:`token ${t}`},body:JSON.stringify({message:"img",content:b64})});const url=`https://${CONFIG.adminUser}.github.io/${CONFIG.repoName}/${n}`;const ta=document.getElementById('content');ta.value=`![Img](${url})\n`+ta.value;document.getElementById('imgStatus').innerText="âœ… Done";}catch(e){alert(e);}}}
    </script>
</body>
</html>
